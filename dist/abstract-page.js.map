{"version":3,"sources":["abstract-page.js"],"names":[],"mappings":"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","file":"abstract-page.js","sourcesContent":["/**\n * Copyright ¬© 2016, Ambroise Maupate\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is furnished\n * to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n * IN THE SOFTWARE.\n *\n * @file abstract-page.js\n * @author Ambroise Maupate\n */\nimport log from \"loglevel\";\nimport TweenMax from \"TweenMax\";\nimport waitForImages from \"waitForImages\";\nimport $ from \"jquery\";\nimport Lazyload from 'Lazyload';\nimport {debounce} from \"utils/debounce\";\n\n/**\n * Base class for creating page implementations.\n *\n * **Do not instanciate this class directly, create a sub-class**.\n */\nexport class AbstractPage {\n    /**\n     * Base constructor for Pages.\n     *\n     * Do not override this method, override `init` method instead.\n     *\n     * @param  {Router}  router\n     * @param  {jQuery}  $cont\n     * @param  {String}  context\n     * @param  {String}  type\n     * @param  {Boolean} isHome\n     */\n    constructor(router, $cont, context, type, isHome) {\n        type = type || 'page';\n\n        if (!$cont) {\n            throw \"AbstractPage need a $cont (JQuery) to be defined.\";\n        }\n        if (!router) {\n            throw \"AbstractPage need a Router instance to be defined.\";\n        }\n        /**\n         *\n         * @type {Router}\n         */\n        this.router = router;\n        /**\n         *\n         * @type {jQuery}\n         */\n        this.$cont = $cont;\n        /**\n         * @type {String}\n         */\n        this.id = $cont[0].id;\n        /**\n         * @type {String}\n         */\n        this.context = context;\n        /**\n         * @type {String}\n         */\n        this.type = type;\n        /**\n         * @type {Boolean}\n         */\n        this.isHome = isHome;\n        /**\n         * @type {Lazyload}\n         */\n        this.lazyload = null;\n\n        if(this.$cont[0].getAttribute('data-is-home') == '1'){\n            this.isHome = true;\n        }\n\n        this.ready = false;\n\n        this.name = (this.$cont.length) ? this.$cont[0].getAttribute('data-node-name') : '';\n\n        this.onResizeDebounce = debounce(this.onResize.bind(this), 50, false);\n\n        log.debug('‚ú≥Ô∏è #' + this.id + '\\t' + type);\n\n        this.init();\n        this.initEvents();\n    }\n\n    /**\n     * Initialize page.\n     *\n     * You should always extends this method in your child implementations instead\n     * of extending page constructor.\n     */\n    init() {\n        this.$link = this.$cont.find('a').not('[target=\"_blank\"]');\n        this.bindedLinkClick = this.router.onLinkClick.bind(this.router);\n\n        // Add target blank on external link\n        if(this.$link.length){\n            this.externalLinkTarget(this.$link, this.router.baseUrl);\n            this.$link = this.$cont.find('a').not('[target=\"_blank\"]');\n        }\n\n        // --- Lazyload --- //\n        if (this.router.options.lazyloadEnabled) {\n            setTimeout(() => {\n                this.beforeLazyload();\n                this.lazyload = new Lazyload({\n                    elements_selector: '.'+this.router.options.lazyloadClass,\n                    data_src: this.router.options.lazyloadSrcAttr.replace('data-', ''),\n                    data_srcset: this.router.options.lazyloadSrcSetAttr.replace('data-', ''),\n                    callback_set: this.onLazyImageSet.bind(this),\n                    callback_load: this.onLazyImageLoad.bind(this),\n                    callback_processed: this.onLazyImageProcessed.bind(this)\n                });\n            }, 0);\n        }\n\n        // --- Blocks --- //\n        this.blocks = [];\n        this.$blocks = this.$cont.find(this.router.options.pageBlockClass);\n        this.blockLength = this.$blocks.length;\n        if(this.blockLength) {\n            this.initBlocks();\n        }\n\n        // --- Context --- //\n        if(this.context == 'static' && this.router.ajaxEnabled) {\n            this.router.pushFirstState(this.isHome);\n        } else if(this.context == 'ajax'){\n            this.initAjax();\n        }\n    }\n\n    /**\n     * Destroy current page and all its blocks.\n     */\n    destroy() {\n        log.debug('üóë #' + this.id);\n        this.$cont.remove();\n        this.destroyEvents();\n        // --- Blocks --- //\n        if (this.blocks !== null) {\n            for (var blockIndex in this.blocks) {\n                this.blocks[blockIndex].destroy();\n            }\n        }\n        /*\n         * Remove Lazyload instance and listeners\n         */\n        if (null !== this.lazyload) {\n            this.lazyload.destroy();\n        }\n    }\n\n    /**\n     * Initialize basic events.\n     *\n     * Such as waitForImages and link click if you enabled Ajax navigation.\n     */\n    initEvents() {\n        if (this.$cont.find('img').length) {\n            this.$cont.waitForImages({\n                finished: this.onLoad.bind(this),\n                waitForAll: true\n            });\n        } else {\n            this.onLoad();\n        }\n\n        if(this.$link.length && this.router.options.ajaxEnabled) {\n            this.$link.on('click', this.bindedLinkClick);\n        }\n\n        this.router.$window.on('resize', this.onResizeDebounce);\n    }\n\n    /**\n     *\n     */\n    destroyEvents() {\n        this.$link.off('click', this.bindedLinkClick);\n        this.router.$window.off('resize', this.onResizeDebounce);\n    }\n\n    /**\n     * @param e\n     * @private\n     */\n    onLoad(e) {\n        this.loadDate = new Date();\n        this.loadDuration = this.loadDate - this.router.loadBeginDate;\n        this.router.nav.update(this);\n\n        const delay = (this.loadDuration > this.router.options.minLoadDuration) ? 0 : this.router.options.minLoadDuration - this.loadDuration;\n\n        // Hide loading\n        setTimeout(() => {\n            const onShowEnded = this.showEnded.bind(this);\n\n            this.ready = true;\n            this.router.loader.hide();\n\n            if(this.context == 'static'){\n                this.show(onShowEnded);\n            } else if(this.context == 'ajax'){\n                // Update body id\n                if(this.name !== '') document.body.id = this.name;\n                // Hide formerPages - show\n                if (this.router.formerPages.length > 0) {\n                    const formerPage = this.router.formerPages[(this.router.formerPages.length - 1)];\n                    const formerPageDestroy = formerPage.destroy.bind(formerPage);\n\n                    /*\n                     * Very important,\n                     * DO NOT animate if there are more than 1 page\n                     * in destroy queue!\n                     */\n                    if (this.router.formerPages.length > 1) {\n                        formerPageDestroy();\n                    } else {\n                        formerPage.hide(formerPageDestroy);\n                    }\n                    this.router.formerPages.pop();\n                }\n\n                this.show(onShowEnded);\n            }\n        }, delay);\n    }\n\n    /**\n     * @param {Function} onShow\n     */\n    show(onShow) {\n        log.debug('‚ñ∂Ô∏è #' + this.id);\n\n        // Animate\n        TweenLite.to(this.$cont, 0.6, {'opacity':1, onComplete: () => {\n            if (typeof onShow !== 'undefined') {\n                onShow();\n            }\n        }});\n    }\n\n    /**\n     *\n     */\n    showEnded() {\n        this.router.transition = false;\n        this.$cont.removeClass(this.router.options.pageClass + '-ajax');\n        this.$cont.removeClass(this.router.options.pageClass + '-transitioning');\n    }\n\n    /**\n     * @param {Function} onHidden\n     */\n    hide(onHidden) {\n        log.debug('‚óÄÔ∏è #' + this.id);\n\n        TweenLite.to(this.$cont, 0.6, {opacity:0, onComplete:onHidden});\n    }\n\n    initAjax() {\n        this.$cont.addClass(this.router.options.pageClass + '-transitioning');\n    }\n\n    /**\n     * @private\n     */\n    initBlocks() {\n        for(let blockIndex = 0; blockIndex < this.blockLength; blockIndex++) {\n            let type = this.$blocks[blockIndex].getAttribute(this.router.options.objectTypeAttr),\n                id = this.$blocks[blockIndex].id;\n\n            let block = this.router.classFactory.getBlockInstance(type, this, this.$blocks.eq(blockIndex));\n            /*\n             * Prevent undefined blocks to be appended to block collection.\n             */\n            if (block) {\n                this.blocks.push(block);\n            }\n        }\n        /*\n         * Notify all blocks that page init is over.\n         */\n        for (let i = this.blocks.length - 1; i >= 0; i--) {\n            if(typeof this.blocks[i].onPageReady == 'function') this.blocks[i].onPageReady();\n        }\n    }\n\n    /**\n     * Get a page block instance from its `id`.\n     *\n     * @param  {String} id\n     * @return {AbstractBlock|null}\n     */\n    getBlockById(id) {\n        for (let i in this.blocks) {\n            if (this.blocks[i] &&\n                this.blocks[i].id &&\n                this.blocks[i].id == id) {\n                return this.blocks[i];\n            }\n        }\n        return null;\n    }\n    \n    /**\n     * Get a page block index from its `id`.\n     *\n     * @param  {String} id\n     * @return {AbstractBlock|null}\n     */\n    getIndexBlockById(id) {\n        for (let i in this.blocks) {\n            if (this.blocks[i] &&\n                this.blocks[i].id &&\n                this.blocks[i].id == id) {\n                return i;\n            }\n        }\n        return null;\n    }\n    \n    /**\n     * Get the first page block instance from its `type`.\n     *\n     * @param  {String} type\n     * @return {AbstractBlock|null}\n     */\n    getFirstBlockByType(type){\n        for (let i in this.blocks) {\n            if (this.blocks[i] &&\n                this.blocks[i].type &&\n                this.blocks[i].type == type) {\n                return this.blocks[i];\n            }\n        }\n        return null;\n    }\n\n    /**\n     * @abstract\n     */\n    onResize(){\n\n    }\n\n    /**\n     * Called before init lazyload images.\n     *\n     * @abstract\n     */\n    beforeLazyload() {\n\n    }\n\n    /**\n     * After image src switched.\n     *\n     * @abstract\n     * @param {HTMLImage} element\n     */\n    onLazyImageSet(element) {\n        log.debug('\\tüñº ¬´'+element.id+'¬ª set');\n    }\n\n    /**\n     * After lazyload image loaded.\n     *\n     * @abstract\n     * @param {HTMLImage} element\n     */\n    onLazyImageLoad(element) {\n        log.debug('\\tüñº ¬´'+element.id+'¬ª load');\n    }\n\n    /**\n     * Before lazyload.\n     *\n     * @abstract\n     */\n    onLazyImageProcessed(index) {\n        log.debug('\\tüñº Lazy load processed');\n    }\n\n    /**\n     * Add target blank to external links.\n     *\n     * @param  {JQuery} $links\n     * @param  {String} baseUrl\n     */\n    externalLinkTarget($links, baseUrl) {\n        const linksLength = $links.length;\n        let abstractBaseUrl = baseUrl.split('://');\n\n        abstractBaseUrl = abstractBaseUrl[1];\n\n        for(let linkIndex = 0; linkIndex < linksLength; linkIndex++){\n            const link = $links[linkIndex];\n            /*\n             * Use RAW href data not to automatically\n             * get protocol and domain in string\n             */\n            const linkString = link.getAttribute('href');\n            if(linkString.indexOf(abstractBaseUrl) == -1 &&\n               linkString.indexOf('javascript') == -1 &&\n               linkString.indexOf('mailto:') == -1 &&\n               linkString.charAt(0) != '/' &&\n               linkString.charAt(0) != '#')\n            {\n                $links[linkIndex].target = '_blank';\n            }\n        }\n    }\n}\n"],"sourceRoot":"/source/"}