{"version":3,"sources":["abstract-page.js"],"names":["AbstractPage","router","$cont","context","type","isHome","id","lazyload","getAttribute","name","length","onResizeDebounce","onResize","bind","debug","init","initEvents","$link","find","not","bindedLinkClick","onLinkClick","externalLinkTarget","baseUrl","options","lazyloadEnabled","setTimeout","beforeLazyload","elements_selector","lazyloadClass","data_src","lazyloadSrcAttr","replace","data_srcset","lazyloadSrcSetAttr","callback_set","onLazyImageSet","callback_load","onLazyImageLoad","callback_processed","onLazyImageProcessed","blocks","$blocks","pageBlockClass","blockLength","initBlocks","ajaxEnabled","pushFirstState","initAjax","destroy","remove","destroyEvents","blockIndex","waitForImages","finished","onLoad","waitForAll","on","$window","off","e","loadDate","Date","loadDuration","loadBeginDate","nav","update","delay","minLoadDuration","onShowEnded","showEnded","loader","hide","show","document","body","formerPages","formerPage","formerPageDestroy","pop","onShow","tween","TweenLite","to","onComplete","transition","removeClass","pageClass","onHidden","opacity","addClass","objectTypeAttr","block","classFactory","getBlockInstance","eq","push","i","onPageReady","getBlockById","element","index","$links","linksLength","abstractBaseUrl","split","linkIndex","link","href","indexOf","charAt","target"],"mappings":"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","file":"abstract-page.js","sourcesContent":["/**\n * Copyright ¬© 2016, Ambroise Maupate\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is furnished\n * to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n * IN THE SOFTWARE.\n *\n * @file abstract-page.js\n * @author Ambroise Maupate\n */\nimport log from \"loglevel\";\nimport TweenMax from \"TweenMax\";\nimport waitForImages from \"waitForImages\";\nimport $ from \"jquery\";\nimport Lazyload from 'Lazyload';\nimport {debounce} from \"utils/debounce\";\n\n/**\n * Base class for creating page implementations.\n *\n * **Do not instanciate this class directly, create a sub-class**.\n */\nexport class AbstractPage {\n    /**\n     * Base constructor for Pages.\n     *\n     * Do not override this method, override `init` method instead.\n     *\n     * @param  {Router}  router\n     * @param  {jQuery}  $cont\n     * @param  {String}  context\n     * @param  {String}  type\n     * @param  {Boolean} isHome\n     */\n    constructor(router, $cont, context, type, isHome) {\n        type = type || 'page';\n\n        if (!$cont) {\n            throw \"AbstractPage need a $cont (JQuery) to be defined.\";\n        }\n        if (!router) {\n            throw \"AbstractPage need a Router instance to be defined.\";\n        }\n        /**\n         *\n         * @type {Router}\n         */\n        this.router = router;\n        /**\n         *\n         * @type {jQuery}\n         */\n        this.$cont = $cont;\n        /**\n         * @type {String}\n         */\n        this.id = $cont[0].id;\n        /**\n         * @type {String}\n         */\n        this.context = context;\n        /**\n         * @type {String}\n         */\n        this.type = type;\n        /**\n         * @type {Boolean}\n         */\n        this.isHome = isHome;\n        /**\n         * @type {Lazyload}\n         */\n        this.lazyload = null;\n\n        if(this.$cont[0].getAttribute('data-is-home') == '1'){\n            this.isHome = true;\n        }\n\n        this.name = (this.$cont.length) ? this.$cont[0].getAttribute('data-node-name') : '';\n\n        this.onResizeDebounce = debounce(this.onResize.bind(this), 50, false);\n\n        log.debug('‚ú≥Ô∏è #' + this.id + '\\t' + type);\n\n        this.init();\n        this.initEvents();\n    }\n\n    /**\n     * Initialize page.\n     *\n     * You should always extends this method in your child implementations instead\n     * of extending page constructor.\n     */\n    init() {\n        this.$link = this.$cont.find('a').not('[target=\"_blank\"]');\n        this.bindedLinkClick = this.router.onLinkClick.bind(this.router);\n\n        // Add target blank on external link\n        if(this.$link.length){\n            this.externalLinkTarget(this.$link, this.router.baseUrl);\n            this.$link = this.$cont.find('a').not('[target=\"_blank\"]');\n        }\n\n        // --- Lazyload --- //\n        if (this.router.options.lazyloadEnabled) {\n            setTimeout(() => {\n                this.beforeLazyload();\n                this.lazyload = new Lazyload({\n                    elements_selector: '.'+this.router.options.lazyloadClass,\n                    data_src: this.router.options.lazyloadSrcAttr.replace('data-', ''),\n                    data_srcset: this.router.options.lazyloadSrcSetAttr.replace('data-', ''),\n                    callback_set: this.onLazyImageSet.bind(this),\n                    callback_load: this.onLazyImageLoad.bind(this),\n                    callback_processed: this.onLazyImageProcessed.bind(this)\n                });\n            }, 0);\n        }\n\n        // --- Blocks --- //\n        this.blocks = [];\n        this.$blocks = this.$cont.find(this.router.options.pageBlockClass);\n        this.blockLength = this.$blocks.length;\n        if(this.blockLength) {\n            this.initBlocks();\n        }\n\n        // --- Context --- //\n        if(this.context == 'static' && this.router.ajaxEnabled) {\n            this.router.pushFirstState(this.isHome);\n        } else if(this.context == 'ajax'){\n            this.initAjax();\n        }\n    }\n\n    /**\n     * Destroy current page and all its blocks.\n     */\n    destroy() {\n        log.debug('üóë #' + this.id);\n        this.$cont.remove();\n        this.destroyEvents();\n        // --- Blocks --- //\n        if (this.blocks !== null) {\n            for (var blockIndex in this.blocks) {\n                this.blocks[blockIndex].destroy();\n            }\n        }\n        /*\n         * Remove Lazyload instance and listeners\n         */\n        if (null !== this.lazyload) {\n            this.lazyload.destroy();\n        }\n    }\n\n    /**\n     * Initialize basic events.\n     *\n     * Such as waitForImages and link click if you enabled Ajax navigation.\n     */\n    initEvents() {\n        if (this.$cont.find('img').length) {\n            this.$cont.waitForImages({\n                finished: this.onLoad.bind(this),\n                waitForAll: true\n            });\n        } else {\n            this.onLoad();\n        }\n\n        if(this.$link.length && this.router.options.ajaxEnabled) {\n            this.$link.on('click', this.bindedLinkClick);\n        }\n\n        this.router.$window.on('resize', this.onResizeDebounce);\n    }\n\n    /**\n     *\n     */\n    destroyEvents() {\n        this.$link.off('click', this.bindedLinkClick);\n        this.router.$window.off('resize', this.onResizeDebounce);\n    }\n\n    /**\n     * @param e\n     * @private\n     */\n    onLoad(e) {\n        this.loadDate = new Date();\n        this.loadDuration = this.loadDate - this.router.loadBeginDate;\n        this.router.nav.update(this);\n\n        const delay = (this.loadDuration > this.router.options.minLoadDuration) ? 0 : this.router.options.minLoadDuration - this.loadDuration;\n\n        // Hide loading\n        setTimeout(() => {\n            const onShowEnded = this.showEnded.bind(this);\n\n            this.router.loader.hide();\n\n            if(this.context == 'static'){\n                this.show(onShowEnded);\n            } else if(this.context == 'ajax'){\n                // Update body id\n                if(this.name !== '') document.body.id = this.name;\n                // Hide formerPages - show\n                if (this.router.formerPages.length > 0) {\n                    const formerPage = this.router.formerPages[(this.router.formerPages.length - 1)];\n                    const formerPageDestroy = formerPage.destroy.bind(formerPage);\n\n                    /*\n                     * Very important,\n                     * DO NOT animate if there are more than 1 page\n                     * in destroy queue!\n                     */\n                    if (this.router.formerPages.length > 1) {\n                        formerPageDestroy();\n                    } else {\n                        formerPage.hide(formerPageDestroy);\n                    }\n                    this.router.formerPages.pop();\n                }\n\n                this.show(onShowEnded);\n            }\n        }, delay);\n    }\n\n    /**\n     * @param {Function} onShow\n     */\n    show(onShow) {\n        log.debug('‚ñ∂Ô∏è #' + this.id);\n        // Animate\n        var tween = TweenLite.to(this.$cont, 0.6, {'opacity':1, onComplete: () => {\n            this.router.transition = false;\n            if (typeof onShow !== 'undefined') {\n                onShow();\n            }\n        }});\n    }\n\n    /**\n     *\n     */\n    showEnded() {\n        this.$cont.removeClass(this.router.options.pageClass + '-ajax');\n        this.$cont.removeClass(this.router.options.pageClass + '-transitioning');\n    }\n\n    /**\n     * @param {Function} onHidden\n     */\n    hide(onHidden) {\n        log.debug('‚óÄÔ∏è #' + this.id);\n        TweenLite.to(this.$cont, 0.6, {opacity:0, onComplete:onHidden});\n    }\n\n    initAjax() {\n        this.$cont.addClass(this.router.options.pageClass + '-transitioning');\n    }\n\n    /**\n     * @private\n     */\n    initBlocks() {\n        for(let blockIndex = 0; blockIndex < this.blockLength; blockIndex++) {\n            let type = this.$blocks[blockIndex].getAttribute(this.router.options.objectTypeAttr),\n                id = this.$blocks[blockIndex].id;\n\n            let block = this.router.classFactory.getBlockInstance(type, this, this.$blocks.eq(blockIndex));\n            /*\n             * Prevent undefined blocks to be appended to block collection.\n             */\n            if (block) {\n                this.blocks.push(block);\n            }\n        }\n        /*\n         * Notify all blocks that page init is over.\n         */\n        for (let i = this.blocks.length - 1; i >= 0; i--) {\n            this.blocks[i].onPageReady();\n        }\n    }\n\n    /**\n     * Get a page‚Äô block instance from its `id`.\n     *\n     * @param  {String} id\n     * @return {AbstractBlock|null}\n     */\n    getBlockById(id) {\n        for (let i in this.blocks) {\n            if (this.blocks[i] &&\n                this.blocks[i].id &&\n                this.blocks[i].id == id) {\n                return this.blocks[i];\n            }\n        }\n        return null;\n    }\n\n    /**\n     * @abstract\n     */\n    onResize(){\n\n    }\n\n    /**\n     * Called before init lazyload images.\n     *\n     * @abstract\n     */\n    beforeLazyload() {\n\n    }\n\n    /**\n     * After image src switched.\n     *\n     * @abstract\n     * @param {HTMLImage} element\n     */\n    onLazyImageSet(element) {\n        log.debug('\\tüñº ¬´'+element.id+'¬ª set');\n    }\n\n    /**\n     * After lazyload image loaded.\n     *\n     * @abstract\n     * @param {HTMLImage} element\n     */\n    onLazyImageLoad(element) {\n        log.debug('\\tüñº ¬´'+element.id+'¬ª load');\n    }\n\n    /**\n     * Before lazyload.\n     *\n     * @abstract\n     */\n    onLazyImageProcessed(index) {\n        log.debug('\\tüñº Lazy load processed');\n    }\n\n    /**\n     * Add target blank to external links.\n     *\n     * @param  {JQuery} $links\n     * @param  {String} baseUrl\n     */\n    externalLinkTarget($links, baseUrl) {\n        const linksLength = $links.length;\n        let abstractBaseUrl = baseUrl.split('://');\n\n        abstractBaseUrl = abstractBaseUrl[1];\n\n        for(let linkIndex = 0; linkIndex < linksLength; linkIndex++){\n            const link = $links[linkIndex];\n            if(link.href.indexOf(abstractBaseUrl) == -1 &&\n               link.href.indexOf('javascript') == -1 &&\n               link.href.indexOf('mailto:') == -1 &&\n               link.href.charAt(0) != '/' &&\n               link.href.charAt(0) != '#')\n            {\n                $links[linkIndex].target = '_blank';\n            }\n        }\n    }\n}\n"],"sourceRoot":"/source/"}